<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="MapLocationApp.Views.MapPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:mapsui="clr-namespace:Mapsui.UI.Maui;assembly=Mapsui.UI.Maui"
             Title="ðŸ—ºï¸ åœ°åœ–å°Žèˆª"
             Background="{StaticResource BackgroundGradient}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- åœ°åœ–å€åŸŸ -->
        <Border Grid.Row="0" 
                StrokeShape="RoundRectangle 20" 
                Stroke="Transparent" 
                Margin="16,16,16,8">
            <Grid>
                <!-- åœ°åœ–æŽ§åˆ¶é … -->
                <mapsui:MapControl x:Name="MapControl" 
                                   VerticalOptions="Fill"
                                   HorizontalOptions="Fill" />

                <!-- æµ®å‹•æŽ§åˆ¶æŒ‰éˆ• -->
                <VerticalStackLayout HorizontalOptions="End" 
                                     VerticalOptions="Start" 
                                     Margin="16" 
                                     Spacing="8">
                    <Button x:Name="LocationButton"
                            Text="ðŸ“"
                            FontSize="20"
                            WidthRequest="48"
                            HeightRequest="48"
                            CornerRadius="24"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="White"
                            Clicked="OnLocationButtonClicked" />
                    
                    <Button x:Name="ZoomInButton"
                            Text="+"
                            FontSize="20"
                            WidthRequest="48"
                            HeightRequest="48"
                            CornerRadius="24"
                            BackgroundColor="{StaticResource CardBackground}"
                            TextColor="{StaticResource Primary}"
                            Clicked="OnZoomInClicked" />
                    
                    <Button x:Name="ZoomOutButton"
                            Text="-"
                            FontSize="20"
                            WidthRequest="48"
                            HeightRequest="48"
                            CornerRadius="24"
                            BackgroundColor="{StaticResource CardBackground}"
                            TextColor="{StaticResource Primary}"
                            Clicked="OnZoomOutClicked" />
                </VerticalStackLayout>

                <!-- Attribution æ¨™ç±¤ -->
                <Border HorizontalOptions="End"
                        VerticalOptions="End"
                        BackgroundColor="{StaticResource CardBackground}"
                        StrokeShape="RoundRectangle 8"
                        Stroke="Transparent"
                        Padding="8"
                        Margin="16"
                        Opacity="0.9">
                    <Label x:Name="AttributionLabel"
                           Text="Â© OpenStreetMap contributors"
                           FontSize="10"
                           TextColor="{StaticResource Gray600}" />
                </Border>

                <!-- ç‹€æ…‹æŒ‡ç¤ºå™¨ -->
                <Border HorizontalOptions="Start"
                        VerticalOptions="Start"
                        BackgroundColor="{StaticResource CardBackground}"
                        StrokeShape="RoundRectangle 8"
                        Stroke="Transparent"
                        Padding="12"
                        Margin="16">
                    <Label x:Name="StatusLabel"
                           Text="ðŸ”„ æº–å‚™å°±ç·’"
                           FontSize="12"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}" />
                </Border>
            </Grid>
        </Border>

        <!-- åº•éƒ¨æŽ§åˆ¶é¢æ¿ -->
        <Border Grid.Row="1" 
                Style="{StaticResource ModernCard}" 
                Margin="16,8,16,16">
            <VerticalStackLayout Spacing="16">
                
                <!-- ä½ç½®è³‡è¨Š -->
                <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto" RowSpacing="4" ColumnSpacing="12">
                    <Label Grid.Row="0" Grid.Column="0" Text="ðŸ“" FontSize="16"/>
                    <Label Grid.Row="0" Grid.Column="1" x:Name="LocationLabel" 
                           Text="ä½ç½®: æº–å‚™ç²å–..." 
                           Style="{StaticResource BodyText}"/>
                    
                    <Label Grid.Row="1" Grid.Column="0" Text="ðŸŽ¯" FontSize="16"/>
                    <Label Grid.Row="1" Grid.Column="1" x:Name="AccuracyLabel"
                           Text="ç²¾ç¢ºåº¦: æœªçŸ¥"
                           Style="{StaticResource CaptionText}"/>
                </Grid>

                <!-- æŽ§åˆ¶æŒ‰éˆ•ç¾¤çµ„ -->
                <Grid ColumnDefinitions="*,*,*" ColumnSpacing="12">
                    <Button Grid.Column="0"
                            Text="ðŸŽ¯ å®šä½"
                            Style="{StaticResource PrimaryButton}"
                            Clicked="OnLocationButtonClicked" />
                    
                    <Picker Grid.Column="1"
                            x:Name="TileProviderPicker"
                            Title="ðŸ—ºï¸ åœ°åœ–é¡žåž‹"
                            Style="{StaticResource ModernPicker}"
                            SelectedIndexChanged="OnTileProviderChanged" />
                    
                    <Button Grid.Column="2"
                            x:Name="GeofenceButton"
                            Text="ðŸ” åœæ¬„"
                            Style="{StaticResource SecondaryButton}"
                            Clicked="OnGeofenceButtonClicked" />
                </Grid>

            </VerticalStackLayout>
        </Border>

    </Grid>

</ContentPage>