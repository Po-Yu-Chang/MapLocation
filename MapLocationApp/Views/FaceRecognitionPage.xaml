<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MapLocationApp.Views.FaceRecognitionPage"
             Title="äººè‡‰è¾¨è­˜"
             Style="{StaticResource DarkPageStyle}">

    <ContentPage.Resources>
        <ResourceDictionary Source="../Resources/Styles/DarkTheme.xaml" />
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- æ¨™é¡Œå€åŸŸ -->
            <Frame Style="{StaticResource CardFrameStyle}">
                <VerticalStackLayout Spacing="10" HorizontalOptions="Center">
                    <Label Text="ðŸ‘¤" FontSize="48" HorizontalOptions="Center"/>
                    <Label Text="AI äººè‡‰è¾¨è­˜ç³»çµ±" Style="{StaticResource TitleLabelStyle}" HorizontalOptions="Center"/>
                    <Label Text="æ™ºæ…§äººè‡‰è¨“ç·´èˆ‡è­˜åˆ¥å¹³å°" Style="{StaticResource LabelStyle}" HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </Frame>

            <!-- åŠŸèƒ½é¸æ“‡å€åŸŸ -->
            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,*" RowSpacing="16" ColumnSpacing="16">
                
                <!-- è¨“ç·´æ¨¡å¼ -->
                <Frame Grid.Row="0" Grid.Column="0" Style="{StaticResource CardFrameStyle}">
                    <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                        <Label Text="ðŸŽ“" FontSize="36" HorizontalOptions="Center"/>
                        <Label Text="è¨“ç·´æ¨¡å¼" Style="{StaticResource LabelStyle}" FontSize="18" FontAttributes="Bold" HorizontalOptions="Center"/>
                        <Label Text="æ–°å¢žäººè‡‰è³‡æ–™åˆ°ç³»çµ±" Style="{StaticResource SmallLabelStyle}" HorizontalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Button Text="é–‹å§‹è¨“ç·´" Style="{StaticResource PrimaryButtonStyle}" 
                                Clicked="OnTrainingModeClicked" WidthRequest="120"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- æ¸¬è©¦æ¨¡å¼ -->
                <Frame Grid.Row="0" Grid.Column="1" Style="{StaticResource CardFrameStyle}">
                    <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                        <Label Text="ðŸ”" FontSize="36" HorizontalOptions="Center"/>
                        <Label Text="æ¸¬è©¦æ¨¡å¼" Style="{StaticResource LabelStyle}" FontSize="18" FontAttributes="Bold" HorizontalOptions="Center"/>
                        <Label Text="è¾¨è­˜å·²è¨“ç·´çš„äººè‡‰" Style="{StaticResource SmallLabelStyle}" HorizontalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Button Text="é–‹å§‹æ¸¬è©¦" Style="{StaticResource SuccessButtonStyle}" 
                                Clicked="OnTestModeClicked" WidthRequest="120"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- ç®¡ç†æ¨¡å¼ -->
                <Frame Grid.Row="1" Grid.Column="0" Style="{StaticResource CardFrameStyle}">
                    <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                        <Label Text="ðŸ“Š" FontSize="36" HorizontalOptions="Center"/>
                        <Label Text="è³‡æ–™ç®¡ç†" Style="{StaticResource LabelStyle}" FontSize="18" FontAttributes="Bold" HorizontalOptions="Center"/>
                        <Label Text="æŸ¥çœ‹å’Œç®¡ç†äººè‡‰è³‡æ–™" Style="{StaticResource SmallLabelStyle}" HorizontalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Button Text="ç®¡ç†è³‡æ–™" Style="{StaticResource SecondaryButtonStyle}" 
                                Clicked="OnManagementModeClicked" WidthRequest="120"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- ç³»çµ±è¨­å®š -->
                <Frame Grid.Row="1" Grid.Column="1" Style="{StaticResource CardFrameStyle}">
                    <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                        <Label Text="âš™ï¸" FontSize="36" HorizontalOptions="Center"/>
                        <Label Text="ç³»çµ±è¨­å®š" Style="{StaticResource LabelStyle}" FontSize="18" FontAttributes="Bold" HorizontalOptions="Center"/>
                        <Label Text="èª¿æ•´è­˜åˆ¥åƒæ•¸è¨­å®š" Style="{StaticResource SmallLabelStyle}" HorizontalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Button Text="ç³»çµ±è¨­å®š" Style="{StaticResource SecondaryButtonStyle}" 
                                Clicked="OnSystemSettingsClicked" WidthRequest="120"/>
                    </VerticalStackLayout>
                </Frame>

            </Grid>

            <!-- å·¥ä½œå€åŸŸ -->
            <Frame x:Name="WorkAreaFrame" Style="{StaticResource CardFrameStyle}" IsVisible="False">
                <StackLayout x:Name="WorkAreaContent" Spacing="15">
                    <Label x:Name="WorkAreaTitle" Text="" Style="{StaticResource LabelStyle}" FontSize="16" FontAttributes="Bold" HorizontalOptions="Center"/>
                    <!-- å‹•æ…‹å…§å®¹å°‡åœ¨é€™è£¡è¼‰å…¥ -->
                </StackLayout>
            </Frame>

            <!-- å½±åƒé¸æ“‡å€åŸŸ -->
            <Frame x:Name="ImageFrame" Style="{StaticResource CardFrameStyle}" IsVisible="False">
                <VerticalStackLayout Spacing="15">
                    <Label Text="é¸æ“‡å½±åƒ" Style="{StaticResource LabelStyle}" FontSize="16" FontAttributes="Bold"/>
                    
                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" Text="ðŸ“· æ‹ç…§" Style="{StaticResource PrimaryButtonStyle}" 
                                Clicked="OnTakePhotoClicked"/>
                        <Button Grid.Column="1" Text="ðŸ“ é¸æ“‡æª”æ¡ˆ" Style="{StaticResource SecondaryButtonStyle}" 
                                Clicked="OnSelectFileClicked"/>
                        <Button Grid.Column="2" Text="âŒ å–æ¶ˆ" Style="{StaticResource SecondaryButtonStyle}" 
                                Clicked="OnCancelClicked"/>
                    </Grid>

                    <!-- å½±åƒé è¦½ -->
                    <Image x:Name="PreviewImage" 
                           HeightRequest="300" 
                           WidthRequest="300"
                           Aspect="AspectFit"
                           BackgroundColor="#2D2D30"
                           IsVisible="False"/>

                    <!-- è™•ç†æŒ‰éˆ• -->
                    <StackLayout x:Name="ProcessingButtons" Orientation="Horizontal" HorizontalOptions="Center" Spacing="10" IsVisible="False">
                        <Button x:Name="ProcessButton" Text="ðŸ”„ è™•ç†å½±åƒ" Style="{StaticResource PrimaryButtonStyle}" 
                                Clicked="OnProcessImageClicked"/>
                        <Button Text="ðŸ—‘ï¸ é‡æ–°é¸æ“‡" Style="{StaticResource SecondaryButtonStyle}" 
                                Clicked="OnResetClicked"/>
                    </StackLayout>

                    <!-- åç¨±è¼¸å…¥ (è¨“ç·´æ¨¡å¼) -->
                    <StackLayout x:Name="NameInputArea" IsVisible="False" Spacing="10">
                        <Label Text="è«‹è¼¸å…¥äººè‡‰åç¨±:" Style="{StaticResource LabelStyle}"/>
                        <Entry x:Name="NameEntry" Placeholder="ä¾‹å¦‚: å¼µä¸‰" Style="{StaticResource DarkEntryStyle}"/>
                        <Button Text="ðŸ’¾ å„²å­˜äººè‡‰" Style="{StaticResource SuccessButtonStyle}" 
                                Clicked="OnSaveFaceClicked"/>
                    </StackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- çµæžœé¡¯ç¤ºå€åŸŸ -->
            <Frame x:Name="ResultFrame" Style="{StaticResource CardFrameStyle}" IsVisible="False">
                <VerticalStackLayout Spacing="15">
                    <Label Text="è™•ç†çµæžœ" Style="{StaticResource LabelStyle}" FontSize="16" FontAttributes="Bold"/>
                    <Label x:Name="ResultLabel" Style="{StaticResource LabelStyle}" HorizontalTextAlignment="Center"/>
                    
                    <!-- åµæ¸¬åˆ°çš„äººè‡‰è³‡è¨Š -->
                    <CollectionView x:Name="DetectedFacesCollection" IsVisible="False">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10" ColumnDefinitions="60,*,80" RowDefinitions="Auto,Auto">
                                    <Label Grid.Column="0" Grid.Row="0" Text="ðŸ‘¤" FontSize="24" VerticalOptions="Center"/>
                                    <Label Grid.Column="1" Grid.Row="0" Text="{Binding Name}" Style="{StaticResource LabelStyle}" FontAttributes="Bold"/>
                                    <Label Grid.Column="2" Grid.Row="0" Text="{Binding Confidence, StringFormat='{0:P1}'}" Style="{StaticResource SmallLabelStyle}" HorizontalTextAlignment="End"/>
                                    <Label Grid.Column="1" Grid.Row="1" Text="{Binding StatusText}" Style="{StaticResource SmallLabelStyle}"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- ç³»çµ±ç‹€æ…‹è³‡è¨Š -->
            <Frame Style="{StaticResource CardFrameStyle}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="ç³»çµ±ç‹€æ…‹" Style="{StaticResource LabelStyle}" FontSize="16" FontAttributes="Bold"/>
                    
                    <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto" RowSpacing="6" ColumnSpacing="10">
                        <Label Grid.Row="0" Grid.Column="0" Text="ðŸ¤–" FontSize="16"/>
                        <Label Grid.Row="0" Grid.Column="1" x:Name="SystemStatusLabel" Text="FaceAiSharp ç³»çµ±: æº–å‚™å°±ç·’" Style="{StaticResource SmallLabelStyle}"/>
                        
                        <Label Grid.Row="1" Grid.Column="0" Text="ðŸ“Š" FontSize="16"/>
                        <Label Grid.Row="1" Grid.Column="1" x:Name="DatabaseStatusLabel" Text="è³‡æ–™åº«: è¼‰å…¥ä¸­..." Style="{StaticResource SmallLabelStyle}"/>
                        
                        <Label Grid.Row="2" Grid.Column="0" Text="ðŸ’¾" FontSize="16"/>
                        <Label Grid.Row="2" Grid.Column="1" x:Name="StorageStatusLabel" Text="å„²å­˜ç©ºé–“: å¯ç”¨" Style="{StaticResource SmallLabelStyle}"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- èªªæ˜Žæ–‡å­— -->
            <Label Text="æç¤ºï¼šWindows å¹³å°æ”¯æ´å®Œæ•´çš„ FaceAiSharp äººè‡‰è¾¨è­˜åŠŸèƒ½ï¼ŒåŒ…æ‹¬é«˜ç²¾åº¦çš„äººè‡‰åµæ¸¬å’Œè­˜åˆ¥ã€‚" 
                   Style="{StaticResource SmallLabelStyle}" 
                   HorizontalOptions="Center" 
                   HorizontalTextAlignment="Center"
                   Margin="0,10,0,20"/>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>